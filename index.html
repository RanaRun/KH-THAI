<!DOCTYPE html>
<html lang="km"> <!-- Set default language to Khmer -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>កម្មវិធីរៀនភាសាថៃ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Custom CSS for basic styling and overrides -->
    <link rel="stylesheet" href="styles/style.css">
</head>
<body class="bg-gray-100 font-inter min-h-screen flex flex-col">
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="fixed inset-0 bg-gray-200 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"></div>
    </div>

    <header class="bg-blue-600 text-white p-4 shadow-md rounded-b-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-bold" data-translate="app_title">កម្មវិធីរៀនភាសាថៃ</h1>
            <div class="flex items-center space-x-4">
                <!-- User ID Display (Removed Firebase dependency) -->
                <span id="user-id-display" class="text-sm bg-blue-700 px-3 py-1 rounded-full">
                    <span data-translate="user_id_label">ID អ្នកប្រើប្រាស់:</span> <span id="current-user-id">Guest</span>
                </span>
                <!-- Language Selector -->
                <div class="relative">
                    <select id="language-selector" class="bg-blue-700 text-white px-3 py-1 rounded-md cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <option value="km">ខ្មែរ</option>
                        <option value="en">English</option>
                        <option value="th">ไทย</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto mt-6 p-4 flex-grow">
        <!-- Navigation Tabs -->
        <nav class="bg-white p-2 rounded-lg shadow-md mb-6 flex flex-wrap justify-center sm:justify-start">
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="home">
                <i class="fas fa-home"></i>
                <span data-translate="home_nav">ទំព័រដើម</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="kindergarten">
                <i class="fas fa-child"></i>
                <span data-translate="kindergarten_nav">ថ្នាក់មតេយ្យ</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="beginner">
                <i class="fas fa-seedling"></i>
                <span data-translate="beginner_nav">កម្រិតចាប់ផ្តើម</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="intermediate">
                <i class="fas fa-book-open"></i>
                <span data-translate="intermediate_nav">កម្រិតកណ្តាល</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="advanced">
                <i class="fas fa-graduation-cap"></i>
                <span data-translate="advanced_nav">កម្រិតខ្ពស់</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="custom-lesson">
                <i class="fas fa-magic"></i>
                <span data-translate="custom_lesson_nav">មេរៀនតាមតម្រូវការ</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="exam">
                <i class="fas fa-question-circle"></i>
                <span data-translate="exam_nav">ប្រឡង</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="flashcards">
                <i class="fas fa-clone"></i>
                <span data-translate="flashcards_nav">Flashcards</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="progress">
                <i class="fas fa-chart-line"></i>
                <span data-translate="progress_nav">របាយការណ៍</span>
            </button>
            <button class="nav-button p-3 rounded-lg text-gray-700 hover:bg-blue-100 hover:text-blue-700 focus:outline-none transition-colors duration-200 flex items-center space-x-2 mr-2 mb-2 sm:mb-0" data-section="bookmarks">
                <i class="fas fa-bookmark"></i>
                <span data-translate="bookmarks_nav">មេរៀនចូលចិត្ត</span>
            </button>
        </nav>

        <!-- Content Sections -->
        <div id="content-area" class="bg-white p-6 rounded-lg shadow-md min-h-[500px]">
            <!-- Home Section (Default View) -->
            <section id="home-section" class="app-section active">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="welcome_title">សូមស្វាគមន៍មកកាន់កម្មវិធីរៀនភាសាថៃ!</h2>
                <p class="text-gray-600 leading-relaxed mb-4" data-translate="welcome_text">កម្មវិធីនេះនឹងជួយអ្នកឱ្យរៀនភាសាថៃតាមរយៈមេរៀនអន្តរកម្ម កម្រងសំណួរ Flashcard និងការតាមដានវឌ្ឍនភាព។</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-volume-up mr-2"></i><span data-translate="feature_audio_title">ស្តាប់សំឡេងជនជាតិដើម</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_audio_desc">ស្តាប់ពាក្យ និងឃ្លាដែលបញ្ចេញសំឡេងដោយអ្នកនិយាយភាសាថៃដើម ដើម្បីកែលម្អការបញ្ចេញសំឡេងរបស់អ្នក។</p>
                    </div>
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-brain mr-2"></i><span data-translate="feature_exam_title">ប្រព័ន្ធប្រឡង</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_exam_desc">សាកល្បងចំណេះដឹងរបស់អ្នកជាមួយនឹងសំណួរជម្រើសច្រើន និងលំហាត់ផ្គូផ្គងពាក្យ។</p>
                    </div>
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-address-card mr-2"></i><span data-translate="feature_flashcards_title">Flashcard ពាក្យសំខាន់ៗ</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_flashcards_desc">រៀនវាក្យស័ព្ទថ្មីៗយ៉ាងងាយស្រួលដោយប្រើ Flashcard អន្តរកម្ម។</p>
                    </div>
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-chart-bar mr-2"></i><span data-translate="feature_progress_title">តាមដានវឌ្ឍនភាព</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_progress_desc">មើលពីរបៀបដែលអ្នករីកចម្រើនជាមួយនឹងរបាយការណ៍កម្រិតចំណេះដឹងលម្អិត។</p>
                    </div>
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-heart mr-2"></i><span data-translate="feature_bookmarks_title">Bookmark មេរៀនចូលចិត្ត</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_bookmarks_desc">រក្សាទុកមេរៀន និងពាក្យដែលអ្នកចង់រៀនម្តងទៀត។</p>
                    </div>
                    <div class="p-4 bg-blue-50 rounded-lg shadow-sm">
                        <h3 class="text-xl font-medium text-blue-700 mb-2 flex items-center"><i class="fas fa-globe mr-2"></i><span data-translate="feature_language_title">ជម្រើសភាសា</span></h3>
                        <p class="text-gray-600 text-sm" data-translate="feature_language_desc">ប្តូរភាសាចំណុចប្រទាក់រវាងខ្មែរ អង់គ្លេស និងថៃ។</p>
                    </div>
                </div>
            </section>

            <!-- Kindergarten Section (New) -->
            <section id="kindergarten-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="kindergarten_title">ថ្នាក់មតេយ្យ</h2>
                <p class="text-gray-600 mb-6" data-translate="kindergarten_intro">សូមស្វាគមន៍មកកាន់មេរៀនថ្នាក់មតេយ្យ! ចូរយើងរៀនពាក្យ និងឃ្លាសាមញ្ញបំផុត។</p>

                <div id="kindergarten-lessons-container" class="space-y-6">
                    <!-- Hardcoded kindergarten lessons -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">แม่</p>
                            <p class="text-lg text-gray-700">ម៉ែ</p>
                            <p class="text-lg text-gray-700">ម្ដាយ</p>
                            <p class="text-md text-gray-500">Mother</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="แม่">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ម៉ែ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">พ่อ</p>
                            <p class="text-lg text-gray-700">ប៉ា</p>
                            <p class="text-lg text-gray-700">ឪពុក</p>
                            <p class="text-md text-gray-500">Father</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="พ่อ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ប៉ា">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">น้ำ</p>
                            <p class="text-lg text-gray-700">ណាំ</p>
                            <p class="text-lg text-gray-700">ទឹក</p>
                            <p class="text-md text-gray-500">Water</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="น้ำ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ណាំ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">กิน</p>
                            <p class="text-lg text-gray-700">គីន</p>
                            <p class="text-lg text-gray-700">ញ៉ាំ/បរិភោគ</p>
                            <p class="text-md text-gray-500">Eat</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="กิน">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="គីន">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">นอน</p>
                            <p class="text-lg text-gray-700">ណន</p>
                            <p class="text-lg text-gray-700">គេង</p>
                            <p class="text-md text-gray-500">Sleep</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="นอน">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ណន">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Beginner Section (Updated with lesson content) -->
            <section id="beginner-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="beginner_title">កម្រិតចាប់ផ្តើម</h2>
                <p class="text-gray-600 mb-6" data-translate="beginner_intro">សូមស្វាគមន៍មកកាន់មេរៀនកម្រិតចាប់ផ្តើម! ចូរយើងរៀនឃ្លាថៃមូលដ្ឋានមួយចំនួន។</p>

                <div id="beginner-lessons-container" class="space-y-6">
                    <!-- Lesson Item 1: Hello -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">สวัสดีครับ/ค่ะ</p>
                            <p class="text-lg text-gray-700">សៈ វ៉ាត់ ឌី ក្រាប់/ខៈ</p>
                            <p class="text-lg text-gray-700">ជំរាបសួរ</p>
                            <p class="text-md text-gray-500">Hello/Greetings</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="สวัสดีครับ/ค่ะ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="សៈ វ៉ាត់ ឌី ក្រាប់/ខៈ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Lesson Item 2: How are you -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">สบายดีไหมครับ/คะ</p>
                            <p class="text-lg text-gray-700">សៈបាយ ឌី ម៉ៃ ក្រាប់/ខៈ</p>
                            <p class="text-lg text-gray-700">សុខសប្បាយជាទេ?</p>
                            <p class="text-md text-gray-500">How are you?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="สบายดีไหมครับ/คะ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="សៈបាយ ឌី ម៉ៃ ក្រាប់/ខៈ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Lesson Item 3: Thank you -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ขอบคุณครับ/ค่ะ</p>
                            <p class="text-lg text-gray-700">ខប់ ឃុន ក្រាប់/ខៈ</p>
                            <p class="text-lg text-gray-700">អរគុណ</p>
                            <p class="text-md text-gray-500">Thank you</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ขอบคุณครับ/ค่ะ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ខប់ ឃុន ក្រាប់/ខៈ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Additional hardcoded beginner lessons -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ขอโทษครับ/ค่ะ</p>
                            <p class="text-lg text-gray-700">ខរ ថូត ក្រាប់/ខៈ</p>
                            <p class="text-lg text-gray-700">សូមទោស</p>
                            <p class="text-md text-gray-500">Excuse me/Sorry</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ขอโทษครับ/ค่ะ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ខរ ថូត ក្រាប់/ខៈ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ไม่เป็นไร</p>
                            <p class="text-lg text-gray-700">ម៉ៃ ប៉ិន រ៉ៃ</p>
                            <p class="text-lg text-gray-700">មិនអីទេ</p>
                            <p class="text-md text-gray-500">No problem/You're welcome</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ไม่เป็นไร">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ម៉ៃ ប៉ិន រ៉ៃ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ไปไหน</p>
                            <p class="text-lg text-gray-700">ប៉ៃ ណៃ</p>
                            <p class="text-lg text-gray-700">ទៅណា</p>
                            <p class="text-md text-gray-500">Where are you going?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ไปไหน">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ប៉ៃ ណៃ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">กินข้าว</p>
                            <p class="text-lg text-gray-700">គីន ខាវ</p>
                            <p class="text-lg text-gray-700">ញ៉ាំបាយ</p>
                            <p class="text-md text-gray-500">Eat rice/meal</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="กินข้าว">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="គីន ខាវ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Intermediate Section (Updated with hardcoded lessons) -->
            <section id="intermediate-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="intermediate_title">កម្រិតកណ្តាល</h2>
                <p class="text-gray-600 mb-6" data-translate="intermediate_intro">សូមស្វាគមន៍មកកាន់មេរៀនកម្រិតកណ្តាល! នៅទីនេះ អ្នកនឹងរៀនឃ្លាដែលស្មុគស្មាញជាងនេះបន្តិច។</p>
                <div id="intermediate-lessons-container" class="space-y-6">
                    <!-- Hardcoded intermediate lessons -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">คุณชื่ออะไรครับ/คะ?</p>
                            <p class="text-lg text-gray-700">ឃុន ឈឺ អៈរ៉ៃ ក្រាប់/ខៈ?</p>
                            <p class="text-lg text-gray-700">អ្នកឈ្មោះអ្វី?</p>
                            <p class="text-md text-gray-500">What is your name?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="คุณชื่ออะไรครับ/คะ?">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ឃុន ឈឺ អៈរ៉ៃ ក្រាប់/ខៈ?">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ฉันไม่เข้าใจ</p>
                            <p class="text-lg text-gray-700">ឆាន់ ម៉ៃ ខៅ ចៃ</p>
                            <p class="text-lg text-gray-700">ខ្ញុំមិនយល់ទេ</p>
                            <p class="text-md text-gray-500">I don't understand</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ฉันไม่เข้าใจ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ឆាន់ ម៉ៃ ខៅ ចៃ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">คุณพูดภาษาอังกฤษได้ไหมครับ/คะ?</p>
                            <p class="text-lg text-gray-700">ឃុន ភូត ភាសាអង់គ្លេស ដាយ ម៉ៃ ក្រាប់/ខៈ?</p>
                            <p class="text-lg text-gray-700">តើអ្នកនិយាយភាសាអង់គ្លេសបានទេ?</p>
                            <p class="text-md text-gray-500">Can you speak English?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="คุณพูดภาษาอังกฤษได้ไหมครับ/คะ?">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ឃុន ភូត ភាសាអង់គ្លេស ដាយ ម៉ៃ ក្រាប់/ខៈ?">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ขอเมนูหน่อยครับ/ค่ะ</p>
                            <p class="text-lg text-gray-700">ខរ មេនូ ណយ ក្រាប់/ខៈ</p>
                            <p class="text-lg text-gray-700">សុំម៉ឺនុយ</p>
                            <p class="text-md text-gray-500">May I have the menu?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ขอเมนูหน่อยครับ/ค่ะ">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ខរ មេនូ ណយ ក្រាប់/ខៈ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ผม/ดิฉันหิวข้าว</p>
                            <p class="text-lg text-gray-700">ផុម/ឌីឆាន់ ហ៊ីវ ខាវ</p>
                            <p class="text-lg text-gray-700">ខ្ញុំឃ្លានបាយ</p>
                            <p class="text-md text-gray-500">I am hungry (for rice/food)</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ผม/ดิฉันหิวข้าว">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ផុម/ឌីឆាន់ ហ៊ីវ ខាវ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advanced Section (Added hardcoded lessons) -->
            <section id="advanced-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="advanced_title">កម្រិតខ្ពស់</h2>
                <p class="text-gray-600 mb-6" data-translate="advanced_intro">សូមស្វាគមន៍មកកាន់មេរៀនកម្រិតខ្ពស់! នៅទីនេះ អ្នកនឹងរៀនឃ្លាស្មុគស្មាញ និងកន្សោម idiomatic។</p>
                <div id="advanced-lessons-container" class="space-y-6">
                    <!-- Hardcoded advanced lessons -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">การเรียนรู้ภาษาใหม่ต้องใช้ความอดทนและเวลา</p>
                            <p class="text-lg text-gray-700">កាន រៀនរូ ភាសា ម៉ៃ តង ឆៃ ខ្វាម អត់ថុន ឡែ វ៉េឡា</p>
                            <p class="text-lg text-gray-700">ការរៀនភាសាថ្មីទាមទារការអត់ធ្មត់ និងពេលវេលា</p>
                            <p class="text-md text-gray-500">Learning a new language requires patience and time.</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="การเรียนรู้ภาษาใหม่ต้องใช้ความอดทนและเวลา">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="កាន រៀនរូ ភាសា ម៉ៃ តង ឆៃ ខ្វាម អត់ថុន ឡែ វ៉េឡា">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">วัฒนธรรมไทยมีเสน่ห์และน่าสนใจมาก</p>
                            <p class="text-lg text-gray-700">វ៉ាត់ថៈណៈធាំ ថៃ មី សៈណេ ឡែ ណា សន ចៃ ម៉ាក</p>
                            <p class="text-lg text-gray-700">វប្បធម៌ថៃមានមន្តស្នេហ៍ និងគួរឱ្យចាប់អារម្មណ៍ណាស់</p>
                            <p class="text-md text-gray-500">Thai culture is very charming and interesting.</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="วัฒนธรรมไทยมีเสน่ห์และน่าสนใจมาก">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="វ៉ាត់ថៈណៈធាំ ថៃ មី សៈណេ ឡែ ណា សន ចៃ ម៉ាក">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">การเดินทางทำให้เราเปิดโลกกว้าง</p>
                            <p class="text-lg text-gray-700">កាន ដឿនថាង ថាំ ហៃ រ៉ៅ ប៉ិត ឡូក ក្វាង</p>
                            <p class="text-lg text-gray-700">ការធ្វើដំណើរធ្វើឱ្យយើងបើកពិភពលោកធំទូលាយ</p>
                            <p class="text-md text-gray-500">Traveling broadens our horizons.</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="การเดินทางทำให้เราเปิดโลกกว้าง">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="កាន ដឿនថាង ថាំ ហៃ រ៉ៅ ប៉ិត ឡូក ក្វាង">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Custom Lesson Section (Now displays static content) -->
            <section id="custom-lesson-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="custom_lesson_title">មេរៀនតាមតម្រូវការ</h2>
                <p class="text-gray-600 mb-6" data-translate="custom_lesson_intro_static">នេះគឺជាមេរៀនគំរូដែលបានបង្កើតឡើងជាមុន។ អ្នកអាចកែសម្រួលវាដោយផ្ទាល់នៅក្នុងកូដ។</p>

                <div id="custom-lesson-output" class="space-y-6">
                    <!-- Hardcoded custom lesson example -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">ฉันอยากสั่งอาหารไทย</p>
                            <p class="text-lg text-gray-700">ឆាន់ យ៉ាក សាំង អាហារ ថៃ</p>
                            <p class="text-lg text-gray-700">ខ្ញុំចង់បញ្ជាម្ហូបថៃ</p>
                            <p class="text-md text-gray-500">I want to order Thai food.</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="ฉันอยากสั่งอาหารไทย">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ឆាន់ យ៉ាក សាំង អាហារ ថៃ">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-blue-800">มีอะไรแนะนำไหมครับ/คะ?</p>
                            <p class="text-lg text-gray-700">មី អៈរ៉ៃ ណែណាំ ម៉ៃ ក្រាប់/ខៈ?</p>
                            <p class="text-lg text-gray-700">មានអ្វីណែនាំទេ?</p>
                            <p class="text-md text-gray-500">Do you have any recommendations?</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="play-audio-button bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-thai-text="มีอะไรแนะนำไหมครับ/คะ?">
                                <i class="fas fa-volume-up text-xl"></i>
                            </button>
                            <button class="play-khmer-phonetic-button bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="មី អៈរ៉ៃ ណែណាំ ម៉ៃ ក្រាប់/ខៈ?">
                                <i class="fas fa-comment-dots text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Exam Section (Now displays static questions) -->
            <section id="exam-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="exam_title">ប្រឡង</h2>
                <p class="text-gray-600 mb-6" data-translate="exam_intro_static">សាកល្បងចំណេះដឹងភាសាថៃរបស់អ្នកជាមួយនឹងសំណួរគំរូ។</p>
                <div id="exam-questions-container" class="space-y-6">
                    <!-- Hardcoded exam questions -->
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm space-y-3">
                        <p class="text-lg font-semibold text-gray-800"><span class="font-bold">សំណួរ:</span> តើ 'สวัสดี' មានន័យដូចម្តេចជាភាសាខ្មែរ?</p>
                        <p class="text-md text-gray-600"><span class="font-bold">Question:</span> What does 'สวัสดี' mean in Khmer?</p>
                        <p class="text-xl font-bold text-blue-800"><span class="font-bold">คำถาม:</span> 'สวัสดี' หมายความว่าอะไรในภาษาเขมร?</p>
                        <div class="options-container space-y-2">
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="0">
                                1. អរគុណ / Thank you / ขอบคุณ
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="true" data-index="1">
                                2. ជំរាបសួរ / Hello / สวัสดี
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="2">
                                3. លាហើយ / Goodbye / ลาก่อน
                            </button>
                        </div>
                        <div class="feedback-message mt-2 text-center font-bold"></div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm space-y-3">
                        <p class="text-lg font-semibold text-gray-800"><span class="font-bold">សំណួរ:</span> តើពាក្យថៃមួយណាមានន័យថា 'ទឹក'?</p>
                        <p class="text-md text-gray-600"><span class="font-bold">Question:</span> Which Thai word means 'water'?</p>
                        <p class="text-xl font-bold text-blue-800"><span class="font-bold">คำถาม:</span> คำภาษาไทยคำใดหมายถึง 'น้ำ'?</p>
                        <div class="options-container space-y-2">
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="0">
                                1. ข้าว / Rice / បាយ
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="true" data-index="1">
                                2. น้ำ / Water / ទឹក
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="2">
                                3. ผลไม้ / Fruit / ផ្លែឈើ
                            </button>
                        </div>
                        <div class="feedback-message mt-2 text-center font-bold"></div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg shadow-sm space-y-3">
                        <p class="text-lg font-semibold text-gray-800"><span class="font-bold">សំណួរ:</span> តើពាក្យថៃមួយណាមានន័យថា 'ឆ្ងាញ់'?</p>
                        <p class="text-md text-gray-600"><span class="font-bold">Question:</span> Which Thai word means 'delicious'?</p>
                        <p class="text-xl font-bold text-blue-800"><span class="font-bold">คำถาม:</span> คำภาษาไทยคำใดหมายถึง 'อร่อย'?</p>
                        <div class="options-container space-y-2">
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="true" data-index="0">
                                1. อร่อย / Delicious / ឆ្ងាញ់
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="1">
                                2. แพง / Expensive / ថ្លៃ
                            </button>
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700" data-correct="false" data-index="2">
                                3. ถูก / Cheap / ថោក
                            </button>
                        </div>
                        <div class="feedback-message mt-2 text-center font-bold"></div>
                    </div>
                </div>
            </section>

            <!-- Flashcards Section (Now displays static flashcards) -->
            <section id="flashcards-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="flashcards_title">Flashcards</h2>
                <p class="text-gray-600 mb-6" data-translate="flashcards_intro_static">រៀនពាក្យ និងឃ្លាថ្មីៗយ៉ាងងាយស្រួលដោយប្រើ Flashcard គំរូ។</p>
                <div id="flashcards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Hardcoded flashcards -->
                    <div class="flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center" tabindex="0">
                        <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                            <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                                <p class="text-3xl font-bold text-blue-800 mb-2">อร่อย</p>
                                <p class="text-lg text-gray-600">អៈរ៉យ</p>
                                <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="អៈរ៉យ">
                                    <i class="fas fa-comment-dots text-lg"></i>
                                </button>
                            </div>
                            <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                                <p class="text-xl font-semibold text-gray-800 mb-1">ឆ្ងាញ់</p>
                                <p class="text-lg text-gray-700">Delicious</p>
                                <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="อร่อย">
                                    <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center" tabindex="0">
                        <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                            <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                                <p class="text-3xl font-bold text-blue-800 mb-2">ราคาเท่าไหร่</p>
                                <p class="text-lg text-gray-600">រ៉ាខា ថៅ រ៉ៃ</p>
                                <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="រ៉ាខា ថៅ រ៉ៃ">
                                    <i class="fas fa-comment-dots text-lg"></i>
                                </button>
                            </div>
                            <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                                <p class="text-xl font-semibold text-gray-800 mb-1">ថ្លៃប៉ុន្មាន?</p>
                                <p class="text-lg text-gray-700">How much?</p>
                                <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="ราคาเท่าไหร่">
                                    <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center" tabindex="0">
                        <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                            <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                                <p class="text-3xl font-bold text-blue-800 mb-2">ห้องน้ำ</p>
                                <p class="text-lg text-gray-600">ហង ណាំ</p>
                                <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="ហង ណាំ">
                                    <i class="fas fa-comment-dots text-lg"></i>
                                </button>
                            </div>
                            <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                                <p class="text-xl font-semibold text-gray-800 mb-1">បន្ទប់ទឹក</p>
                                <p class="text-lg text-gray-700">Restroom</p>
                                <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="ห้องน้ำ">
                                    <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center" tabindex="0">
                        <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                            <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                                <p class="text-3xl font-bold text-blue-800 mb-2">อรุณสวัสดิ์</p>
                                <p class="text-lg text-gray-600">អៈរុន សៈវ៉ាត់</p>
                                <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="អៈរុន សៈវ៉ាត់">
                                    <i class="fas fa-comment-dots text-lg"></i>
                                </button>
                            </div>
                            <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                                <p class="text-xl font-semibold text-gray-800 mb-1">អរុណសួស្តី</p>
                                <p class="text-lg text-gray-700">Good morning</p>
                                <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="อรุณสวัสดิ์">
                                    <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center" tabindex="0">
                        <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                            <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                                <p class="text-3xl font-bold text-blue-800 mb-2">ราตรีสวัสดิ์</p>
                                <p class="text-lg text-gray-600">រ៉ាត្រី សៈវ៉ាត់</p>
                                <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="រ៉ាត្រី សៈវ៉ាត់">
                                    <i class="fas fa-comment-dots text-lg"></i>
                                </button>
                            </div>
                            <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                                <p class="text-xl font-semibold text-gray-800 mb-1">រាត្រីសួស្តី</p>
                                <p class="text-lg text-gray-700">Good night</p>
                                <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="ราตรีสวัสดิ์">
                                    <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Progress Section (Now displays static report) -->
            <section id="progress-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="progress_title">របាយការណ៍កម្រិតចំណេះដឹង</h2>
                <p class="text-gray-600 mb-6" data-translate="progress_intro_static">នេះគឺជារបាយការណ៍វឌ្ឍនភាពគំរូ។</p>
                <div id="progress-report-container" class="bg-blue-50 p-4 rounded-lg shadow-sm text-gray-700 leading-relaxed">
                    <p data-translate="progress_content_static">
                        សូមអបអរសាទរចំពោះវឌ្ឍនភាពដ៏អស្ចារ្យរបស់អ្នកក្នុងការរៀនភាសាថៃ! អ្នកបានបង្ហាញពីភាពជាប់លាប់ដ៏គួរឱ្យកត់សម្គាល់ក្នុងការអនុវត្តប្រចាំថ្ងៃរបស់អ្នក។
                        វាក្យសព្ទរបស់អ្នកបានរីកចម្រើនយ៉ាងឆាប់រហ័ស ហើយអ្នកកំពុងចាប់ផ្តើមយល់ពីឃ្លាស្មុគស្មាញកាន់តែច្រើន។
                        ការបញ្ចេញសំឡេងរបស់អ្នកបានប្រសើរឡើងគួរឱ្យកត់សម្គាល់ ជាពិសេសនៅក្នុងព្យាង្គដែលមានសម្លេង។
                        ដើម្បីបន្តការរីកចម្រើនរបស់អ្នក សូមពិចារណាផ្តោតលើការកែលម្អការនិយាយឱ្យស្ទាត់ជំនាញដោយការអនុវត្តជាមួយអ្នកនិយាយដើម
                        និងការយល់ដឹងអំពីវេយ្យាករណ៍ស្មុគស្មាញបន្ថែមទៀត ដូចជាការប្រើប្រាស់ភាគល្អិត និងរចនាសម្ព័ន្ធប្រយោគ។
                        ការអានរឿងខ្លីៗ ឬអត្ថបទព័ត៌មានជាភាសាថៃក៏អាចជួយពង្រឹងជំនាញរបស់អ្នកផងដែរ។
                        បន្តការខិតខំប្រឹងប្រែងរបស់អ្នក!
                    </p>
                </div>
            </section>

            <!-- Bookmarks Section (Now displays static bookmarks) -->
            <section id="bookmarks-section" class="app-section hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4" data-translate="bookmarks_title">មេរៀនចូលចិត្ត</h2>
                <p class="text-gray-600 mb-6" data-translate="bookmarks_intro_static">គ្រប់គ្រងមេរៀន និងពាក្យដែលអ្នកចូលចិត្តនៅទីនេះ។</p>
                <div id="bookmarks-list-container" class="space-y-3">
                    <!-- Hardcoded bookmarks -->
                    <div class="bg-blue-50 p-3 rounded-lg shadow-sm flex flex-col items-start">
                        <p class="text-lg font-semibold text-blue-800"><i class="fas fa-bookmark text-blue-500 mr-2"></i> ឃ្លាសម្រាប់ធ្វើដំណើរ</p>
                        <p class="text-md text-gray-700 ml-6">(Travel Phrases)</p>
                        <p class="text-sm text-gray-500 ml-6">(วลีสำหรับการเดินทาง)</p>
                    </div>
                    <div class="bg-blue-50 p-3 rounded-lg shadow-sm flex flex-col items-start">
                        <p class="text-lg font-semibold text-blue-800"><i class="fas fa-bookmark text-blue-500 mr-2"></i> វាក្យសព្ទម្ហូបអាហារ</p>
                        <p class="text-md text-gray-700 ml-6">(Food Vocabulary)</p>
                        <p class="text-sm text-gray-500 ml-6">(คำศัพท์อาหาร)</p>
                    </div>
                    <div class="bg-blue-50 p-3 rounded-lg shadow-sm flex flex-col items-start">
                        <p class="text-lg font-semibold text-blue-800"><i class="fas fa-bookmark text-blue-500 mr-2"></i> ឃ្លាសម្រាប់សណ្ឋាគារ</p>
                        <p class="text-md text-gray-700 ml-6">(Hotel Phrases)</p>
                        <p class="text-sm text-gray-500 ml-6">(วลีสำหรับโรงแรม)</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-gray-800 text-white p-4 text-center mt-6 rounded-t-lg">
        <p>&copy; 2025 <span data-translate="app_title_footer">កម្មវិធីរៀនភាសាថៃ</span>. <span data-translate="footer_text">រក្សាសិទ្ធិគ្រប់យ៉ាង។</span></p>
    </footer>

    <script>
        // Wrap the entire app logic in an IIFE and use a flag to ensure it runs only once
        // This helps prevent 'Identifier already declared' errors in environments that might re-execute scripts.
        if (typeof window.thaiLanguageAppInitialized === 'undefined') {
            window.thaiLanguageAppInitialized = true;

            // Show loading spinner
            function showLoadingSpinner() {
                document.getElementById('loading-spinner').classList.remove('hidden');
            }

            // Hide loading spinner
            function hideLoadingSpinner() {
                document.getElementById('loading-spinner').classList.add('hidden');
            }

            // Language translations
            const translations = {
                km: {
                    "app_title": "កម្មវិធីរៀនភាសាថៃ",
                    "app_title_footer": "កម្មវិធីរៀនភាសាថៃ",
                    "home_nav": "ទំព័រដើម",
                    "kindergarten_nav": "ថ្នាក់មតេយ្យ",
                    "beginner_nav": "កម្រិតចាប់ផ្តើម",
                    "intermediate_nav": "កម្រិតកណ្តាល",
                    "advanced_nav": "កម្រិតខ្ពស់",
                    "custom_lesson_nav": "មេរៀនតាមតម្រូវការ",
                    "exam_nav": "ប្រឡង",
                    "flashcards_nav": "Flashcards",
                    "progress_nav": "របាយការណ៍",
                    "bookmarks_nav": "មេរៀនចូលចិត្ត",
                    "welcome_title": "សូមស្វាគមន៍មកកាន់កម្មវិធីរៀនភាសាថៃ!",
                    "welcome_text": "កម្មវិធីនេះនឹងជួយអ្នកឱ្យរៀនភាសាថៃតាមរយៈមេរៀនអន្តរកម្ម កម្រងសំណួរ Flashcard និងការតាមដានវឌ្ឍនភាព។",
                    "feature_audio_title": "ស្តាប់សំឡេងជនជាតិដើម",
                    "feature_audio_desc": "ស្តាប់ពាក្យ និងឃ្លាដែលបញ្ចេញសំឡេងដោយអ្នកនិយាយភាសាថៃដើម ដើម្បីកែលម្អការបញ្ចេញសំឡេងរបស់អ្នក។",
                    "feature_exam_title": "ប្រព័ន្ធប្រឡង",
                    "feature_exam_desc": "សាកល្បងចំណេះដឹងរបស់អ្នកជាមួយនឹងសំណួរជម្រើសច្រើន និងលំហាត់ផ្គូផ្គងពាក្យ។",
                    "feature_flashcards_title": "Flashcard ពាក្យសំខាន់ៗ",
                    "feature_flashcards_desc": "រៀនវាក្យស័ព្ទថ្មីៗយ៉ាងងាយស្រួលដោយប្រើ Flashcard អន្តរកម្ម។",
                    "feature_progress_title": "តាមដានវឌ្ឍនភាព",
                    "feature_progress_desc": "មើលពីរបៀបដែលអ្នករីកចម្រើនជាមួយនឹងរបាយការណ៍កម្រិតចំណេះដឹងលម្អិត។",
                    "feature_bookmarks_title": "Bookmark មេរៀនចូលចិត្ត",
                    "feature_bookmarks_desc": "រក្សាទុកមេរៀន និងពាក្យដែលអ្នកចង់រៀនម្តងទៀត។",
                    "feature_language_title": "ជម្រើសភាសា",
                    "feature_language_desc": "ប្តូរភាសាចំណុចប្រទាក់រវាងខ្មែរ អង់គ្លេស និងថៃ។",
                    "kindergarten_title": "ថ្នាក់មតេយ្យ",
                    "kindergarten_intro": "សូមស្វាគមន៍មកកាន់មេរៀនថ្នាក់មតេយ្យ! ចូរយើងរៀនពាក្យ និងឃ្លាសាមញ្ញបំផុត។",
                    "beginner_title": "កម្រិតចាប់ផ្តើម",
                    "beginner_intro": "សូមស្វាគមន៍មកកាន់មេរៀនកម្រិតចាប់ផ្តើម! ចូរយើងរៀនឃ្លាថៃមូលដ្ឋានមួយចំនួន។",
                    "custom_lesson_title": "មេរៀនតាមតម្រូវការ",
                    "custom_lesson_intro_static": "នេះគឺជាមេរៀនគំរូដែលបានបង្កើតឡើងជាមុន។ អ្នកអាចកែសម្រួលវាដោយផ្ទាល់នៅក្នុងកូដ។",
                    "exam_title": "ប្រឡង",
                    "exam_intro_static": "សាកល្បងចំណេះដឹងភាសាថៃរបស់អ្នកជាមួយនឹងសំណួរគំរូ។",
                    "flashcards_title": "Flashcards",
                    "flashcards_intro_static": "រៀនពាក្យ និងឃ្លាថ្មីៗយ៉ាងងាយស្រួលដោយប្រើ Flashcard គំរូ។",
                    "progress_title": "របាយការណ៍កម្រិតចំណេះដឹង",
                    "progress_intro_static": "នេះគឺជារបាយការណ៍វឌ្ឍនភាពគំរូ។",
                    "bookmarks_title": "មេរៀនចូលចិត្ត",
                    "bookmarks_intro_static": "គ្រប់គ្រងមេរៀន និងពាក្យដែលអ្នកចូលចិត្តនៅទីនេះ។",
                    "footer_text": "រក្សាសិទ្ធិគ្រប់យ៉ាង។",
                    "user_id_label": "ID អ្នកប្រើប្រាស់:",
                    "tts_not_supported_error": "Browser របស់អ្នកមិនគាំទ្រមុខងារសំឡេងអានទេ។",
                    "tts_error": "មានបញ្ហាក្នុងការអានសំឡេង។"
                },
                en: {
                    "app_title": "Thai Language Learning App",
                    "app_title_footer": "Thai Language Learning App",
                    "home_nav": "Home",
                    "kindergarten_nav": "Kindergarten",
                    "beginner_nav": "Beginner",
                    "intermediate_nav": "Intermediate",
                    "advanced_nav": "Advanced",
                    "custom_lesson_nav": "Custom Lesson",
                    "exam_nav": "Exam",
                    "flashcards_nav": "Flashcards",
                    "progress_nav": "Progress Report",
                    "bookmarks_nav": "Favorite Lessons",
                    "welcome_title": "Welcome to the Thai Language Learning App!",
                    "welcome_text": "This app will help you learn Thai through interactive lessons, quizzes, flashcards, and progress tracking.",
                    "feature_audio_title": "Native Speaker Audio",
                    "feature_audio_desc": "Listen to words and phrases pronounced by native Thai speakers to improve your pronunciation.",
                    "feature_exam_title": "Exam System",
                    "feature_exam_desc": "Test your knowledge with multiple-choice questions and word matching exercises.",
                    "feature_flashcards_title": "Essential Word Flashcards",
                    "feature_flashcards_desc": "Learn new vocabulary easily using interactive flashcards.",
                    "feature_progress_title": "Track Progress",
                    "feature_progress_desc": "See how you're improving with detailed knowledge level reports.",
                    "feature_bookmarks_title": "Bookmark Favorite Lessons",
                    "feature_bookmarks_desc": "Save lessons and words you want to revisit.",
                    "feature_language_title": "Language Options",
                    "feature_language_desc": "Switch the interface language between Khmer, English, and Thai.",
                    "kindergarten_title": "Kindergarten Level",
                    "kindergarten_intro": "Welcome to the kindergarten lessons! Let's learn the simplest words and phrases.",
                    "beginner_title": "Beginner Level",
                    "beginner_intro": "Welcome to the beginner lessons! Let's learn some basic Thai phrases.",
                    "custom_lesson_title": "Custom Lesson",
                    "custom_lesson_intro_static": "This is a sample pre-generated lesson. You can edit it directly in the code.",
                    "exam_title": "Exam",
                    "exam_intro_static": "Test your Thai language knowledge with sample questions.",
                    "flashcards_title": "Flashcards",
                    "flashcards_intro_static": "Easily learn new words and phrases using sample flashcards.",
                    "progress_title": "Knowledge Progress Report",
                    "progress_intro_static": "This is a sample progress report.",
                    "bookmarks_title": "Favorite Lessons",
                    "bookmarks_intro_static": "Manage your favorite lessons and words here.",
                    "footer_text": "All rights reserved.",
                    "user_id_label": "User ID:",
                    "tts_not_supported_error": "Your browser does not support text-to-speech.",
                    "tts_error": "Error speaking text."
                },
                th: {
                    "app_title": "แอปพลิเคชันเรียนภาษาไทย",
                    "app_title_footer": "แอปพลิเคชันเรียนภาษาไทย",
                    "home_nav": "หน้าหลัก",
                    "kindergarten_nav": "ระดับอนุบาล",
                    "beginner_nav": "ระดับเริ่มต้น",
                    "intermediate_nav": "ระดับกลาง",
                    "advanced_nav": "ระดับสูง",
                    "custom_lesson_nav": "บทเรียนที่กำหนดเอง",
                    "exam_nav": "แบบทดสอบ",
                    "flashcards_nav": "แฟลชการ์ด",
                    "progress_nav": "รายงานความคืบหน้า",
                    "bookmarks_nav": "บทเรียนที่ชื่นชอบ",
                    "welcome_title": "ยินดีต้อนรับสู่แอปพลิเคชันเรียนภาษาไทย!",
                    "welcome_text": "แอปพลิเคชันนี้จะช่วยให้คุณเรียนภาษาไทยผ่านบทเรียนแบบโต้ตอบ แบบทดสอบ แฟลชการ์ด และการติดตามความคืบหน้า",
                    "feature_audio_title": "เสียงจากเจ้าของภาษา",
                    "feature_audio_desc": "ฟังคำและวลีที่ออกเสียงโดยเจ้าของภาษาไทยเพื่อปรับปรุงการออกเสียงของคุณ",
                    "feature_exam_title": "ระบบแบบทดสอบ",
                    "feature_exam_desc": "ทดสอบความรู้ของคุณด้วยคำถามปรนัยและแบบฝึกหัดจับคู่คำศัพท์",
                    "feature_flashcards_title": "แฟลชการ์ดคำศัพท์ที่สำคัญ",
                    "feature_flashcards_desc": "เรียนรู้คำศัพท์ใหม่ได้อย่างง่ายดายโดยใช้แฟลชการ์ดแบบโต้ตอบ",
                    "feature_progress_title": "ติดตามความคืบหน้า",
                    "feature_progress_desc": "ดูว่าคุณกำลังพัฒนาขึ้นอย่างไรด้วยรายงานระดับความรู้โดยละเอียด",
                    "feature_bookmarks_title": "บุ๊กมาร์กบทเรียนที่ชื่นชอบ",
                    "feature_bookmarks_desc": "บันทึกบทเรียนและคำศัพท์ที่คุณต้องการทบทวน",
                    "feature_language_title": "ตัวเลือกภาษา",
                    "feature_language_desc": "เปลี่ยนภาษาของอินเทอร์เฟซระหว่าง เขมร อังกฤษ และไทย",
                    "kindergarten_title": "ระดับอนุบาล",
                    "kindergarten_intro": "ยินดีต้อนรับสู่บทเรียนระดับอนุบาล! มาเรียนรู้คำศัพท์และวลีที่ง่ายที่สุดกัน",
                    "beginner_title": "ระดับเริ่มต้น",
                    "beginner_intro": "ยินดีต้อนรับสู่บทเรียนระดับเริ่มต้น! มาเรียนรู้ประโยคภาษาไทยพื้นฐานกัน",
                    "custom_lesson_title": "บทเรียนที่กำหนดเอง",
                    "custom_lesson_intro_static": "นี่คือบทเรียนตัวอย่างที่สร้างไว้ล่วงหน้า คุณสามารถแก้ไขได้โดยตรงในโค้ด",
                    "exam_title": "แบบทดสอบ",
                    "exam_intro_static": "ทดสอบความรู้ภาษาไทยของคุณด้วยคำถามตัวอย่าง",
                    "flashcards_title": "แฟลชการ์ด",
                    "flashcards_intro_static": "เรียนรู้คำศัพท์และวลีใหม่ ๆ ได้อย่างง่ายดายโดยใช้แฟลชการ์ดตัวอย่าง",
                    "progress_title": "รายงานความคืบหน้าของความรู้",
                    "progress_intro_static": "นี่คือรายงานความคืบหน้าตัวอย่าง",
                    "bookmarks_title": "บทเรียนที่ชื่นชอบ",
                    "bookmarks_intro_static": "จัดการบทเรียนและคำศัพท์ที่คุณชื่นชอบที่นี่",
                    "footer_text": "สงวนลิขสิทธิ์ทุกประการ",
                    "user_id_label": "รหัสผู้ใช้:",
                    "tts_not_supported_error": "เบราว์เซอร์ของคุณไม่รองรับคุณสมบัติการแปลงข้อความเป็นคำพูด",
                    "tts_error": "เกิดข้อผิดพลาดในการออกเสียงข้อความ"
                }
            };

            let currentLang = 'km'; // Default language

            // Function to apply translations based on currentLang
            function applyTranslations() {
                const currentTranslation = translations[currentLang];

                // Update specific elements that don't use data-translate or need special handling
                document.querySelector('h1').textContent = currentTranslation['app_title'];
                document.querySelector('footer p').innerHTML = `&copy; 2025 <span data-translate="app_title_footer">${currentTranslation['app_title_footer']}</span>. <span data-translate="footer_text">${currentTranslation['footer_text']}</span>`;
                document.querySelector('#user-id-display span[data-translate="user_id_label"]').textContent = currentTranslation['user_id_label'];

                // Update elements with data-translate attribute
                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.dataset.translate;
                    // Exclude elements where content is handled by child elements (e.g., spans inside h3 or footer)
                    if (element.tagName === 'SPAN' || element.tagName === 'P' || element.tagName === 'H2' || element.tagName === 'BUTTON' || element.tagName === 'TEXTAREA' || element.tagName === 'INPUT' || element.tagName === 'LABEL') {
                        if (currentTranslation[key]) {
                            // For textarea and input, update placeholder
                            if ((element.tagName === 'TEXTAREA' || element.tagName === 'INPUT') && element.hasAttribute('placeholder')) {
                                element.setAttribute('placeholder', currentTranslation[key]);
                            } else {
                                element.textContent = currentTranslation[key];
                            }
                        }
                    }
                });
            }

            // Function to create an Exam Question HTML element (retained for consistency with hardcoded data)
            function createQuizQuestionElement(question) {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-blue-50 p-4 rounded-lg shadow-sm space-y-3';
                questionDiv.innerHTML = `
                    <p class="text-lg font-semibold text-gray-800"><span class="font-bold">សំណួរ:</span> ${question.questionKhmer}</p>
                    <p class="text-md text-gray-600"><span class="font-bold">Question:</span> ${question.questionEnglish}</p>
                    <p class="text-xl font-bold text-blue-800"><span class="font-bold">คำถาม:</span> ${question.questionThai}</p>
                    <div class="options-container space-y-2">
                        ${question.options.map((option, index) => `
                            <button class="option-button w-full text-left bg-white hover:bg-blue-100 p-3 rounded-md border border-gray-300 transition-colors duration-200 text-gray-700"
                                data-correct="${index === question.correctAnswerIndex ? 'true' : 'false'}"
                                data-index="${index}">
                                ${index + 1}. ${option.textKhmer} / ${option.textEnglish} / ${option.textThai}
                            </button>
                        `).join('')}
                    </div>
                    <div class="feedback-message mt-2 text-center font-bold"></div>
                `;

                // Add event listeners for options
                questionDiv.querySelectorAll('.option-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const isCorrect = button.dataset.correct === 'true';
                        const feedbackDiv = questionDiv.querySelector('.feedback-message');
                        // Reset all buttons
                        questionDiv.querySelectorAll('.option-button').forEach(btn => {
                            btn.classList.remove('bg-green-200', 'bg-red-200', 'border-green-500', 'border-red-500');
                        });

                        if (isCorrect) {
                            button.classList.add('bg-green-200', 'border-green-500');
                            feedbackDiv.textContent = currentLang === 'km' ? 'ត្រឹមត្រូវ!' : currentLang === 'en' ? 'Correct!' : 'ถูกต้อง!';
                            feedbackDiv.classList.remove('text-red-500');
                            feedbackDiv.classList.add('text-green-500');
                        } else {
                            button.classList.add('bg-red-200', 'border-red-500');
                            feedbackDiv.textContent = currentLang === 'km' ? 'ខុសហើយ!' : currentLang === 'en' ? 'Incorrect!' : 'ผิด!';
                            feedbackDiv.classList.remove('text-green-500');
                            feedbackDiv.classList.add('text-red-500');
                            // Highlight correct answer
                            questionDiv.querySelector(`.option-button[data-correct="true"]`).classList.add('bg-green-200', 'border-green-500');
                        }
                    });
                });

                return questionDiv;
            }

            // Function to create a Flashcard HTML element (retained for consistency with hardcoded data)
            function createFlashcardElement(flashcard) {
                const flashcardDiv = document.createElement('div');
                flashcardDiv.className = 'flashcard bg-blue-50 p-6 rounded-lg shadow-md cursor-pointer transform transition-transform duration-500 perspective-1000 relative h-48 flex items-center justify-center'; // Added perspective
                flashcardDiv.setAttribute('tabindex', '0'); // Make it focusable for keyboard users

                flashcardDiv.innerHTML = `
                    <div class="flashcard-inner relative w-full h-full text-center transition-transform duration-500 transform-style-preserve-3d">
                        <div class="flashcard-face flashcard-front absolute w-full h-full backface-hidden flex flex-col items-center justify-center">
                            <p class="text-3xl font-bold text-blue-800 mb-2">${flashcard.thaiWord}</p>
                            <p class="text-lg text-gray-600">${flashcard.phoneticTranscription}</p>
                             <button class="play-khmer-phonetic-button mt-3 bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-khmer-phonetic-text="${flashcard.phoneticTranscription}">
                                <i class="fas fa-comment-dots text-lg"></i>
                            </button>
                        </div>
                        <div class="flashcard-face flashcard-back absolute w-full h-full backface-hidden flex flex-col items-center justify-center rotate-y-180">
                            <p class="text-xl font-semibold text-gray-800 mb-1">${flashcard.khmerTranslation}</p>
                            <p class="text-lg text-gray-700">${flashcard.englishTranslation}</p>
                            <button class="play-audio-button mt-3 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-md transition-colors duration-200" data-thai-text="${flashcard.thaiWord}">
                                <i class="fas fa-volume-up text-lg"></i>
                                </button>
                            </div>
                        </div>
                    `;

                flashcardDiv.addEventListener('click', () => {
                    flashcardDiv.querySelector('.flashcard-inner').classList.toggle('rotate-y-180');
                });
                return flashcardDiv;
            }

            // Function to create a Bookmark HTML element (retained for consistency with hardcoded data)
            function createBookmarkElement(bookmark) {
                const bookmarkDiv = document.createElement('div');
                bookmarkDiv.className = 'bg-blue-50 p-3 rounded-lg shadow-sm flex flex-col items-start';
                bookmarkDiv.innerHTML = `
                    <p class="text-lg font-semibold text-blue-800"><i class="fas fa-bookmark text-blue-500 mr-2"></i> ${bookmark.titleKhmer}</p>
                    <p class="text-md text-gray-700 ml-6">(${bookmark.titleEnglish})</p>
                    <p class="text-sm text-gray-500 ml-6">(${bookmark.titleThai})</p>
                `;
                return bookmarkDiv;
            }


            // Initialize on window load
            window.onload = async function() {
                showLoadingSpinner();
                // No Firebase initialization needed anymore
                document.getElementById('current-user-id').textContent = 'Guest'; // Static guest ID
                document.getElementById('user-id-display').classList.remove('opacity-0'); // Show user ID
                hideLoadingSpinner();
                document.querySelector('.nav-button[data-section="home"]').click(); // Activate home section on load
            };

            // UI Logic for section switching
            document.querySelectorAll('.nav-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    // Remove active class from all buttons
                    document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('bg-blue-500', 'text-white'));
                    // Add active class to clicked button
                    event.currentTarget.classList.add('bg-blue-500', 'text-white');

                    // Hide all sections
                    document.querySelectorAll('.app-section').forEach(section => section.classList.add('hidden'));
                    // Show the selected section
                    const targetSectionId = event.currentTarget.dataset.section + '-section';
                    document.getElementById(targetSectionId).classList.remove('hidden');
                });
            });

            // Audio playback logic (now using Web Speech API)
            document.addEventListener('click', (event) => {
                // Handle Thai audio playback
                if (event.target.closest('.play-audio-button')) {
                    const button = event.target.closest('.play-audio-button');
                    const thaiText = button.dataset.thaiText; // Get Thai text from data attribute

                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(thaiText);
                        // Try to find a Thai voice
                        let thaiVoice = speechSynthesis.getVoices().find(voice => voice.lang === 'th-TH' || voice.lang.startsWith('th-') && voice.name.includes('Thai'));
                        // If a Thai voice is not immediately available, try again after voices are loaded
                        if (!thaiVoice) {
                            speechSynthesis.onvoiceschanged = () => {
                                thaiVoice = speechSynthesis.getVoices().find(voice => voice.lang === 'th-TH' || voice.lang.startsWith('th-') && voice.name.includes('Thai'));
                                if (thaiVoice) utterance.voice = thaiVoice;
                                speechSynthesis.speak(utterance); // Speak once voice is found
                            };
                        } else {
                             utterance.voice = thaiVoice;
                        }

                        // Optional: Add visual feedback for playing audio
                        button.classList.add('animate-pulse');
                        utterance.onend = () => {
                            button.classList.remove('animate-pulse');
                        };
                        utterance.onerror = (e) => {
                            button.classList.remove('animate-pulse');
                            console.error("Speech synthesis error (Thai):", e);
                            alert(translations[currentLang]['tts_error'] || "Error speaking text.");
                        };
                        // Speak immediately if voice is already found, otherwise wait for onvoiceschanged
                        if (thaiVoice) {
                            speechSynthesis.speak(utterance);
                        }
                    } else {
                        alert(translations[currentLang]['tts_not_supported_error'] || "Your browser does not support text-to-speech.");
                        console.error("Web Speech API not supported.");
                    }
                }

                // Handle Khmer phonetic audio playback
                if (event.target.closest('.play-khmer-phonetic-button')) {
                    const button = event.target.closest('.play-khmer-phonetic-button');
                    const khmerPhoneticText = button.dataset.khmerPhoneticText; // Get Khmer phonetic text from data attribute

                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(khmerPhoneticText);
                        // Explicitly set language to English for phonetic transcriptions
                        utterance.lang = 'en-US'; // Use an English voice for phonetic pronunciation

                        // Optional: Add visual feedback for playing audio
                        button.classList.add('animate-pulse');
                        utterance.onend = () => {
                            button.classList.remove('animate-pulse');
                        };
                        utterance.onerror = (e) => {
                            button.classList.remove('animate-pulse');
                            console.error("Speech synthesis error (Khmer phonetic):", e);
                            alert(translations[currentLang]['tts_error'] || "Error speaking text.");
                        };
                        speechSynthesis.speak(utterance);
                    } else {
                        alert(translations[currentLang]['tts_not_supported_error'] || "Your browser does not support text-to-speech.");
                        console.error("Web Speech API not supported.");
                    }
                }
            });

            // Language selector logic
            document.getElementById('language-selector').addEventListener('change', (event) => {
                currentLang = event.target.value;
                applyTranslations();
            });

            // Initial application of translations
            applyTranslations();

            // Manually populate exam questions and flashcards using their respective creation functions
            // This ensures consistency in rendering with the hardcoded data.
            const examQuestionsData = [
                {
                    questionThai: "ตื่นเช้า",
                    questionKhmer: 'តើ "ตื่นเช้า" មានន័យដូចម្តេចជាភាសាខ្មែរ?',
                    questionEnglish: 'What does "ตื่นเช้า" mean in Khmer?',
                    options: [
                        { textThai: "เข้านอน", textKhmer: "ចូលគេង", textEnglish: "Go to bed" },
                        { textThai: "ភ្ញាក់ពីព្រឹក", textKhmer: "ភ្ញាក់ពីព្រឹក", textEnglish: "Wake up early" },
                        { textThai: "กินข้าว", textKhmer: "ញ៉ាំបាយ", textEnglish: "Eat rice" }
                    ],
                    correctAnswerIndex: 1
                },
                {
                    questionThai: "ไปตลาด",
                    questionKhmer: 'តើ "ไปตลาด" មានន័យដូចម្តេចជាភាសាខ្មែរ?',
                    questionEnglish: 'What does "ไปตลาด" mean in Khmer?',
                    options: [
                        { textThai: "ไปផ្ទះ", textKhmer: "ទៅផ្ទះ", textEnglish: "Go home" },
                        { textThai: "ไปสาลารៀน", textKhmer: "ទៅសាលារៀន", textEnglish: "Go to school" },
                        { textThai: "ไปផ្សារ", textKhmer: "ទៅផ្សារ", textEnglish: "Go to market" }
                    ],
                    correctAnswerIndex: 2
                },
                {
                    questionThai: "อร่อย",
                    questionKhmer: 'តើពាក្យថៃមួយណាមានន័យថា "ឆ្ងាញ់"?',
                    questionEnglish: 'Which Thai word means "delicious"?',
                    options: [
                        { textThai: "อร่อย", textKhmer: "ឆ្ងាញ់", textEnglish: "Delicious" },
                        { textThai: "แพง", textKhmer: "ថ្លៃ", textEnglish: "Expensive" },
                        { textThai: "ถูก", textKhmer: "ថោក", textEnglish: "Cheap" }
                    ],
                    correctAnswerIndex: 0
                },
                {
                    questionThai: "เท่าไหร่",
                    questionKhmer: 'តើពាក្យថៃមួយណាមានន័យថា "ប៉ុន្មាន" (តម្លៃ)?',
                    questionEnglish: 'Which Thai word means "how much" (price)?',
                    options: [
                        { textThai: "อะไร", textKhmer: "អ្វី", textEnglish: "What" },
                        { textThai: "เมื่อไหร่", textKhmer: "ពេលណា", textEnglish: "When" },
                        { textThai: "เท่าไหร่", textKhmer: "ប៉ុន្មាន", textEnglish: "How much" }
                    ],
                    correctAnswerIndex: 2
                }
            ];

            const flashcardsData = [
                { thaiWord: "อร่อย", khmerTranslation: "ឆ្ងាញ់", englishTranslation: "Delicious", phoneticTranscription: "អៈរ៉យ" },
                { thaiWord: "ราคาเท่าไหร่", khmerTranslation: "ថ្លៃប៉ុន្មាន?", englishTranslation: "How much?", phoneticTranscription: "រ៉ាខា ថៅ រ៉ៃ" },
                { thaiWord: "ห้องน้ำ", khmerTranslation: "បន្ទប់ទឹក", englishTranslation: "Restroom", phoneticTranscription: "ហង ណាំ" },
                { thaiWord: "อรุณสวัสดิ์", khmerTranslation: "អរុណសួស្តី", englishTranslation: "Good morning", phoneticTranscription: "អៈរុន សៈវ៉ាត់" },
                { thaiWord: "ราตรีสวัสดิ์", khmerTranslation: "រាត្រីសួស្តី", englishTranslation: "Good night", phoneticTranscription: "រ៉ាត្រី សៈវ៉ាត់" },
                { thaiWord: "สบายดี", khmerTranslation: "សុខសប្បាយ", englishTranslation: "Fine/Well", phoneticTranscription: "សៈបាយ ឌី" },
                { thaiWord: "ขอโทษ", khmerTranslation: "សូមទោស", englishTranslation: "Excuse me/Sorry", phoneticTranscription: "ខរ ថូត" }
            ];

            const examQuestionsContainer = document.getElementById('exam-questions-container');
            examQuestionsData.forEach(q => examQuestionsContainer.appendChild(createQuizQuestionElement(q)));

            const flashcardsContainer = document.getElementById('flashcards-container');
            flashcardsData.forEach(fc => flashcardsContainer.appendChild(createFlashcardElement(fc)));

        } // End of if (typeof window.thaiLanguageAppInitialized === 'undefined')
    </script>
</body>
</html>
